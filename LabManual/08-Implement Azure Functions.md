---
wts:
    title: '08 - Azure Functions の実装 (5 分)'
    module: 'モジュール 03: コア ソリューションおよび管理ツールに関する説明'
---
# 08 - Azure Functions の実装 (5 分)

このチュートリアルでは、HTTP 要求がある場合に Hello メッセージを表示する関数アプリを作成します。 

# タスク 1: 関数アプリを作成する 

このタスクでは、関数アプリを作成します。

1. Azure portal　([https://portal.azure.com](https://portal.azure.com))にサインインします。

2. Azure portalで「**関数アプリ**」を検索して選択し、「**関数アプリ**」ブレードで **「+ 作成」** をクリックします。

3. 「**関数アプリ**」ブレードの「**基本**」タブで次の設定を指定します（関数アプリ名の **xxxx** は、名前がグローバルに一意になるように文字と数字に置き換え、その他の設定はすべて既定値のままにしておきます）。

    | 設定 | 値 |
    | -- | --|
    | サブスクリプション | **Azure Pass - スポンサープラン** |
    | リソース グループ（新規作成） | **AzureStudent##** |
    | 関数アプリ名 | **function-##$$$$** |
    | 公開 | **コード** |
    | ランタイム スタック | **.NET** |
    | バージョン | **3.1** |
    | リージョン | **East US** |

    注：##は受講番号を、$$$$は本日の月日を入力します。 (例：受講番号01、9月30日の場合→eduwebapps010930)

    

4. 「**確認および作成**」をクリックし、検証が完了したら「**作成**」をクリックして、Azure 関数アプリのデプロイを開始します。

5. リソースが作成されたことを示す通知を待ちます。

6. デプロイが完了したら、デプロイ ブレードで「リソースに移動」をクリックします。または、「**関数アプリ**」ブレードに戻り、「**更新**」をクリックして、新しく作成した関数アプリの状態が「**実行中**」であることを確認します。 

    ![新しい関数アプリを使用した「関数アプリ」ページのスクリーンショット。](./images/0701.png)

# タスク 2: HTTP トリガー関数を作成してテストします。

このタスクでは、Webhook + API 関数を使用して、HTTP 要求がある場合にメッセージを表示します。 

1. 「**関数アプリ**」 ブレードで、新しく作成した関数アプリをクリックします。 

2. 「**関数**」セクションで、「**関数**」をクリックしてから「**+ 作成**」をクリックします。

    ![Azure Portal 内のドット ネットの「はじめに」ペインの Azure Functions の開発環境の選択手順のスクリーンショット。新しいポータル内関数を作成するための表示要素が強調表示されます。強調表示される要素は、関数アプリの展開、新しい関数の追加、ポータル内、そして続行ボタンです。](./images/0702.png)

3. 「**関数の追加**」ウィンドウが右側に表示されます。「**テンプレートの選択**」セクションで、「**HTTP trigger**」を選択して「**作成**」をクリックします 

    ![Azure Portal 内のドット ネットの [はじめに] ペインの Azure Functions で関数を作成する手順のスクリーンショット。Azure Functions に新しい webhook を追加するために使用する表示要素を示す HTTP トリガー カードが強調表示されます。](./images/0702a.png)

4. 「**HttpTrigger1**」ブレードの「**Developer**」セクションで、「**コード と テスト**」をクリックします。 

5. 「**コード と テスト**」ブレードで、自動で生成されたコードを確認し、コードが HTTP 要求に対する応答とログ出力を実行する内容であることを確認します。また、この関数は任意の名称と Hello メッセージを返します。 

    ![関数コードのスクリーンショット。Hello メッセージが強調表示されます。](./images/0704.png)

6. 関数エディターの上部セクションで「**関数の URL の取得**」をクリックします。 

7. 「**キー**」ドロップダウン リストの値が「**default**」となっていることを確認し、「**コピー**」をクリックして関数の URL をコピーします。 

    ![Azure ポータルの関数エディター内の関数 URL 取得ペインのスクリーンショット。「関数の URL の取得」ボタン、「キー」を設定するドロップダウン リスト、URL の「コピー」ボタンの表示要素が強調表示され、関数エディターから関数の URL を取得してコピーする方法が示されます。](./images/0705.png)

8. 新しいブラウザー タブを開いて、コピーした関数の URL を Web ブラウザーのアドレス バーに貼り付けます。ページが要求されると、関数を実行します。返されるメッセージには、関数に要求本文内の名前が必要であることが表示されます。

    ![名前の提供を求めるメッセージのスクリーンショット。](./images/0706.png)

9. URL の末尾に **&name=*yourname*** を追加します（**yourname**の部分を任意の名称に変更してください）。

    **注**: たとえば、名前が Cindy の場合、最終的な URL は次のようになります。 `https://function-xxxx.azurewebsites.net/api/HttpTrigger1?code=X9xx9999xXXXXX9x9xxxXX==&name=cindy`

    ![強調表示された関数 URL のスクリーンショットと、Web ブラウザーのアドレス バーに追加されたユーザー名の例。メイン ブラウザー ウィンドウ内に関数の出力を示す Hello メッセージとユーザー名も強調表示されます。](./images/0707.png)

10. Enter キーを押すと、関数が実行され、すべての呼び出しがトレースされます。Azure portal でトレースを表示するには、**「HttpTrigger1 | コード と テスト」** ブレードに戻って **「モニター」** をクリックします。タイムスタンプを選択して、**「Application Insights でのクエリの実行する」** をクリックして、Application Insights を**構成**できます。

    ![Azure Portal の関数エディター内で関数を実行した結果のトレース情報ログのスクリーンショット。](./images/0709.png) 

これでHTTP 要求がある場合に Hello メッセージを表示する関数アプリを作成できました。 
